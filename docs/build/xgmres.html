<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>XGMRES · XGMRES.jl</title><meta name="title" content="XGMRES · XGMRES.jl"/><meta property="og:title" content="XGMRES · XGMRES.jl"/><meta property="twitter:title" content="XGMRES · XGMRES.jl"/><meta name="description" content="Documentation for XGMRES.jl."/><meta property="og:description" content="Documentation for XGMRES.jl."/><meta property="twitter:description" content="Documentation for XGMRES.jl."/><meta property="og:url" content="https://bvieuble.github.io/XGMRES.jl/xgmres.html"/><meta property="twitter:url" content="https://bvieuble.github.io/XGMRES.jl/xgmres.html"/><link rel="canonical" href="https://bvieuble.github.io/XGMRES.jl/xgmres.html"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">XGMRES.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">Overview</a></li><li class="is-active"><a class="tocitem" href="xgmres.html">XGMRES</a></li><li><a class="tocitem" href="preconditioners.html">Preconditioners</a></li><li><a class="tocitem" href="auxiliary.html">Auxiliary Functions</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="xgmres.html">XGMRES</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="xgmres.html">XGMRES</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/bvieuble/XGMRES.jl/blob/main/docs/src/xgmres.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="XGMRES"><a class="docs-heading-anchor" href="#XGMRES">XGMRES</a><a id="XGMRES-1"></a><a class="docs-heading-anchor-permalink" href="#XGMRES" title="Permalink"></a></h1><p>The <a href="xgmres.html#XGMRES.xgmres"><code>xgmres</code></a> solver, combined with a given preconditioner, can make use of up to six different floating point arithmetics. For the sake of readability, we use the following set of consistent notations to identify easily the precision at which a given variable is stored and an operation is performed. These notations are consistent accross this  documentation and the source code. You can find below a table listing the different operations, their associated floating point datatype, and the  subscript used for this floating point datatype.</p><table><tr><th style="text-align: left">Operations</th><th style="text-align: left">Floating point datatype</th><th style="text-align: left">Subscript</th></tr><tr><td style="text-align: left">Residual <span>$Ax_{i+1} - b$</span></td><td style="text-align: left"><span>$u_r$</span></td><td style="text-align: left"><code>r</code></td></tr><tr><td style="text-align: left">Update <span>$x_{i+1} = x_{i} + d_{i}$</span></td><td style="text-align: left"><span>$u$</span></td><td style="text-align: left">no subscript</td></tr><tr><td style="text-align: left">Preconditioner computation</td><td style="text-align: left"><span>$u_x$</span></td><td style="text-align: left"><code>x</code></td></tr><tr><td style="text-align: left">Preconditioner application <span>$M\times v$</span></td><td style="text-align: left"><span>$u_m$</span></td><td style="text-align: left"><code>m</code></td></tr><tr><td style="text-align: left">Matrix application <span>$A\times v$</span></td><td style="text-align: left"><span>$u_a$</span></td><td style="text-align: left"><code>a</code></td></tr><tr><td style="text-align: left">Rest of the GMRES operations</td><td style="text-align: left"><span>$u_s$</span></td><td style="text-align: left"><code>s</code></td></tr></table><p>For instance, if a variable is noted <code>varₓ</code>, this variable is stored in precision <span>$u_x$</span> and is likely associated to the preconditioner computation.</p><p>The floating point arithmetic <span>$u$</span> is also refered to as the <em>working precision</em>. This is the arithmetic at which the solution <code>x</code> of  <a href="xgmres.html#XGMRES.xgmres"><code>xgmres</code></a> is delivered. We also use this notation when  it is not pertinent to make a distinction between different floating point arithmetics. Similarly, we do not add subscript to a variable in those cases.</p><p>Finally, in some parts of the code we refer to variables explicitly stored in  <code>Float64</code> or <code>Float128</code> (through the  <a href="https://github.com/JuliaMath/Quadmath.jl">Quadmath</a> package). For those cases we use the following subscripts.</p><table><tr><th style="text-align: left">Floating point datatype</th><th style="text-align: left">Subscript</th></tr><tr><td style="text-align: left"><code>Float64</code></td><td style="text-align: left"><code>e</code></td></tr><tr><td style="text-align: left"><code>Floar128</code></td><td style="text-align: left"><code>t</code></td></tr></table><p>Note that we would have liked subscripts <code>d</code> and <code>q</code>, respectively for <code>Float64</code> (double precision) and <code>Float128</code> (quadruple precision), but Julia&#39;s unicode does not have these options.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="XGMRES.xgmres" href="#XGMRES.xgmres"><code>XGMRES.xgmres</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">x::Vector{u}, stats::Dict = xgmres(
    A         ::AbstractMatrix{TA},                  
    b         ::AbstractVector{TB};                  
    precond   ::Preconditioner            = nothing, 
    kind      ::String                    = &quot;left&quot;,  
    xexact    ::Union{Vector{TX},Nothing} = nothing, 
    maxrestrt ::Union{Integer,   Nothing} = nothing, 
    m         ::Union{Integer,   Nothing} = nothing, 
    τ         ::Union{Float64,   Nothing} = nothing, 
    bstop     ::Union{Float64,   Nothing} = nothing, 
    fstop     ::Union{Float64,   Nothing} = nothing, 
    stop      ::Union{Float64,   Nothing} = nothing, 
    verbose   ::Bool                      = true,    
    do_stats  ::Bool                      = false,   
    do_κ      ::Bool                      = false,   
    u         ::DataType                  = Float64, 
    uᵣ        ::DataType                  = Float64, 
    uₛ        ::DataType                  = Float64, 
    maxmem    ::Float64                   = 3*1e9    
) where {TA&lt;:AbstractFloat,TB&lt;:AbstractFloat,TX&lt;:AbstractFloat}</code></pre><p>Solve the linear system <span>$Ax=b$</span> with mixed precision restarted preconditioned  GMRES, where <span>$A\in\mathbb{R}^{n\times n}$</span> and <span>$x,b \in\mathbb{R}^n$</span>. The function requires three precision parameters and repeats the three  following steps until convergence:</p><ol><li>Compute the residual <span>$r_i = b-Ax_i$</span> in precision <span>$u_r$</span></li><li>Solve <span>$A d_i = r_i/||r_i||_{\infty}$</span> with preconditioned GMRES run in  precision <span>$u_s$</span></li><li>Update the solution <span>$x_{i+1} = x_i + ||r_i||_{\infty}\times d_i$</span> in  precision <span>$u$</span></li></ol><p>The precisions <span>$u_r$</span> and <span>$u$</span>  concern, respectively, the precisions at  which the residual (step 1) and the update of the solution (step 3) are  computed. The precision <span>$u_s$</span> is the precision at which all the operations of the inner GMRES, except the preconditioned matrix-vector product, are computed (step 2). The preconditioned matrix-vector product should be provided through  the <code>precond</code> parameter.</p><div class="admonition is-info"><header class="admonition-header">Preconditioned matrix-vector product</header><div class="admonition-body"><p>The preconditioned matrix-vector product can use its own set of precisions  and does not have to be implemented in precision <span>$uₛ$</span>. One should use  the <code>Preconditioner</code> structure provided by the package to implement it or  use provided implementations by the package. </p></div></div><p>The algorithm is composed of two imbricated loops: the outer restart loop and  the inner GMRES iterations. The restart loop is stopped if:</p><ul><li>We reached the maximum number of restart iterations <code>maxrestrt</code>.</li><li>We observe no significant error reduction over three consecutives  iterations. This is quantified by the parameter <code>stop</code> which defines the maximum acceptable ratio between  the forward errors of two consecutive iterations. </li><li>We reached the expected accuracies on the forward and backward errors  defined by the parameters <code>fstop</code> and <code>bstop</code>.</li></ul><p>If the parameter <code>xexact</code> is not provided, the forward error is not computed,  and the above stopping criterion are solely based on the computed backward  error. The backward and forward error of the linear system are computed,  respectively, as follows:</p><p class="math-container">\[\frac{||Ax_i-b||_{\infty}}{||A||_{\infty}||x_i||_{\infty} + 
||b||_{\infty}},\]</p><p class="math-container">\[\frac{||x_i - x||_{\infty}}{||x||_{\infty}}.\]</p><p>The inner GMRES loop is stopped if:</p><ul><li>We reached the maximum number of GMRES iterations <code>m</code>.</li><li>The backward error of the preconditioned system <span>$Ad_i=r_i$</span> falls below a  given tolerance defined by the paramter <code>τ</code>.</li></ul><p>The backward error of the preconditioned system is computed as follows:</p><p class="math-container">\[\frac{||M^{-1}(Ad_{i,j} - r_i/||r_i||_{\infty})||_{\infty}}{||M^{-1}r_i/
||r_i||_{\infty}||_{\infty}} \qquad \text{(left-preconditioned)}\]</p><p class="math-container">\[\frac{||Ad_{i,j} - r_i/||r_i||_{\infty})||_{\infty}}{||r_i/
||r_i||_{\infty}||_{\infty}} \qquad \text{(right-preconditioned)}\]</p><div class="admonition is-info"><header class="admonition-header">Right-preconditioned backward error</header><div class="admonition-body"><p>The backward error of the right-preconditioned system is the backward error of the original system <span>$A d_i = r_i/||r_i||_{\infty}$</span>.</p></div></div><p>Through the parameter <code>do_stats</code>, it can be asked to the function to compute  the backward errors of the original system <span>$Ax=b$</span> for each iteration of GMRES.  The forward errors are also computed if the exact solution of the system is  provided through the parameter <code>xexact</code>. The condition numbers of the  preconditioner and the preconditioned matrix can also be computed through  another parameter <code>do_κ</code>. It lets the possibility to compute the <code>do_stats</code>  advanced errors on systems where the condition number is too expensive or  impossible to compute.</p><div class="admonition is-warning"><header class="admonition-header">Stats mode</header><div class="admonition-body"><p>The stat mode increases substantially the resource comsumption and is only  relevant for numerical study of the algorithm. It is not intended to be  used in practice.</p></div></div><p><strong>Input arguments</strong></p><ul><li><code>A</code>: A square general matrix <span>$A\in\mathbb{R}^{n\times n}$</span></li><li><code>b</code>: A right-hand side <span>$b\in\mathbb{R}^n$</span></li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>precond</code>: A <a href="preconditioners.html#XGMRES.Preconditioner"><code>Preconditioner</code></a> object embedding the linear operators  used for preconditioning</li><li><code>kind</code>: Set the kind of preconditioning (&quot;left&quot;, &quot;right&quot;, or &quot;flexible&quot;)</li><li><code>xexact</code>: Exact solution of the system. If provided the forward error is  computed in stat mode.</li><li><code>maxrestrt</code>: Maximum number of restart iterations.</li><li><code>m</code>: Maxmum number of inner GMRES iterations.</li><li><code>τ</code>: Stopping criterion for the inner iterations of GMRES based on the  backward error of the correction system <span>$A d_i = r_i/||r_i||_{\infty}$</span>.</li><li><code>bstop</code>: Stopping criterion for the outer restart iterations based on the  backward error of the original system <span>$A x_i = b$</span>.</li><li><code>fstop</code>: Stopping criterion for the outer restart iterations based on the  forward error of the original system.</li><li><code>stop</code>: Stopping criterion for the outer restart iterations based on the  based on the non-improvement of the forward error over 3 iterations. If the forward error is not improved by a ratio higher than <code>stop</code> for three  consecutive restart iterations, the algorithm is stopped.</li><li><code>verbose</code>: Information and convergence logs are displayed at each iteration.</li><li><code>do_stats</code>: Activate the stats mode and get many more logs.</li><li><code>do_κ</code>: Compute the condition numbers of the preconditioner <span>$M$</span> and the preconditioned matrix <span>$AM$</span> or <span>$MA$</span> (depending on the kind of  preconditioning used).</li><li><code>u</code>: Precision at which the update <span>$x_{i+1} = x_{i} + d_{i}$</span> is computed.</li><li><code>uᵣ</code>: Precision at which the residual <span>$Ax_{i+1} - b$</span> is computed.</li><li><code>uₛ</code>: Precision at which the operations in the inner loop of GMRES are  computed.</li><li><code>maxmem</code>: Use to set <code>m</code> if <code>m</code> is not provided in argument. It chooses <code>m</code> such that the memory used to store the Krylov bases is lower than <code>maxmem</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bvieuble/XGMRES.jl/blob/9254722b87b48776169c04f879a0f6c464008e1a/src/XGMRES.jl#L24-L156">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="index.html">« Overview</a><a class="docs-footer-nextpage" href="preconditioners.html">Preconditioners »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Wednesday 8 January 2025 10:44">Wednesday 8 January 2025</span>. Using Julia version 1.11.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
